# Component Diagrams

## API Gateway Components

```
┌─────────────────────────────────────────────────┐
│ API Gateway Service                           │
├─────────────────────────────────────────────────┤
│                                                 │
│ ┌──────────────┐ ┌──────────────┐              │
│ │ Express      │ │ Middleware   │              │
│ │ Router       │◄─────┤ Stack      │              │
│ └──────┬───────┘ └──────────────┘              │
│        │         │                              │
│        ├──► Rate Limiter                        │
│        ├──► CORS Handler                        │
│        ├──► JWT Validator                       │
│        ├──► Error Handler                       │
│        └──► Request Logger                      │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ Route Handlers                   │           │
│ ├──────────────────────────────────┤           │
│ │ /api/terraform/*                 │           │
│ │ /api/aws/*                       │           │
│ │ /api/reports/*                   │           │
│ │ /api/auth/* (proxy)              │           │
│ └──────────────────────────────────┘           │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ Service Connectors               │           │
│ ├──────────────────────────────────┤           │
│ │ Auth Service Client              │           │
│ │ TF Cost Engine Client            │           │
│ │ AWS Pricing Client               │           │
│ │ Reports Service Client           │           │
│ └──────────────────────────────────┘           │
│                                                 │
└─────────────────────────────────────────────────┘
```

## Terraform Cost Engine Components

```
┌─────────────────────────────────────────────────┐
│ Terraform Cost Engine Service                 │
├─────────────────────────────────────────────────┤
│                                                 │
│ ┌──────────────┐ ┌──────────────┐              │
│ │ FastAPI      │ │ Models       │              │
│ │ Router       │ │              │              │
│ └──────┬───────┘ └──────────────┘              │
│        │         │                              │
│        ┌──────▼────────────────────────────┐   │
│        │ API Endpoints                     │   │
│        ├───────────────────────────────────┤   │
│        │ POST /estimate                    │   │
│        │ POST /diff                        │   │
│        │ GET /health                       │   │
│        └──────┬────────────────────────────┘   │
│               │                              │
│        ┌──────▼────────────────────────────┐   │
│        │ Service Layer                     │   │
│        ├───────────────────────────────────┤   │
│        │ ┌─────────────────────┐           │   │
│        │ │ Terraform Runner    │           │   │
│        │ │ - init()            │           │   │
│        │ │ - plan()            │           │   │
│        │ │ - show()            │           │   │
│        │ └─────────────────────┘           │   │
│        │                                   │   │
│        │ ┌─────────────────────┐           │   │
│        │ │ Infracost Runner    │           │   │
│        │ │ - breakdown()       │           │   │
│        │ │ - diff()            │           │   │
│        │ └─────────────────────┘           │   │
│        │                                   │   │
│        │ ┌─────────────────────┐           │   │
│        │ │ Git Handler         │           │   │
│        │ │ - clone()           │           │   │
│        │ │ - pull()            │           │   │
│        │ └─────────────────────┘           │   │
│        │                                   │   │
│        │ ┌─────────────────────┐           │   │
│        │ │ Cost Parser         │           │   │
│        │ │ - parse_output()    │           │   │
│        │ │ - group_by_service  │           │   │
│        │ └─────────────────────┘           │   │
│        └───────────────────────────────────┘   │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ Utility Layer                    │           │
│ ├──────────────────────────────────┤           │
│ │ File Handler                     │           │
│ │ Docker Sandbox                   │           │
│ │ Logger                           │           │
│ └──────────────────────────────────┘           │
│                                                 │
└─────────────────────────────────────────────────┘
```

## Frontend Component Structure

```
┌─────────────────────────────────────────────────┐
│ Frontend Application                          │
├─────────────────────────────────────────────────┤
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ App Layout                       │           │
│ │ ┌────────────────────────────┐   │           │
│ │ │ Header                     │   │           │
│ │ └────────────────────────────┘   │           │
│ │ ┌────────┬────────────────────┐   │           │
│ │ │Sidebar │ Main Content       │   │           │
│ │ │        │                    │   │           │
│ │ └────────┴────────────────────┘   │           │
│ └──────────────────────────────────┘           │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ Pages                            │           │
│ ├──────────────────────────────────┤           │
│ │ /dashboard                       │           │
│ │ /login                           │           │
│ │ /terraform                       │           │
│ │ /calculators/ec2                 │           │
│ │ /calculators/rds                 │           │
│ │ /calculators/s3                  │           │
│ │ /calculators/eks                 │           │
│ │ /reports                         │           │
│ └──────────────────────────────────┘           │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ State Management                 │           │
│ ├──────────────────────────────────┤           │
│ │ Auth Store (Zustand)             │           │
│ │ Cost Store (Zustand)             │           │
│ │ Reports Store (Zustand)          │           │
│ └──────────────────────────────────┘           │
│                                                 │
│ ┌──────────────────────────────────┐           │
│ │ API Integration                  │           │
│ ├──────────────────────────────────┤           │
│ │ Axios HTTP Client                │           │
│ │ API Endpoints                    │           │
│ │ Error Interceptors               │           │
│ └──────────────────────────────────┘           │
│                                                 │
└─────────────────────────────────────────────────┘
```